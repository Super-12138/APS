import{_ as $,r as k,aJ as A,bm as z,q as D,s as F,v as j,aK as S,c as r,e as u,d as o,h as c,f as U,F as i,a4 as C,o as a,i as y,j as _,k as b,t as h,p as J,l as W,E as G}from"./index-ba92c6b8.js";import{E as H,a as L}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as X}from"./CommonPlan-b2bd4878.js";import{P as Y}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const g=V=>(J("data-v-19809c4c"),V=V(),W(),V),Z={class:"container"},w=g(()=>o("span",{class:"first"},"新增",-1)),ee=[w],te=g(()=>o("span",null,"修改",-1)),le=[te],ae=g(()=>o("span",null,"删除",-1)),oe=[ae],se=g(()=>o("span",null,"刷新",-1)),ue=[se],ne=g(()=>o("button",null,[o("span",null,"导入")],-1)),de=g(()=>o("button",null,[o("span",null,"导出")],-1)),re={class:"main"},ce={class:"bottom"},ie={__name:"outsourcedOrder",setup(V){let N=k(1),v=k(20);A();const d=z();D(),F();function M(t){v.value=t,d.getAllPage(N.value,v.value,4).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}k([]),k([]);let I=!0;const x={result:{billNo:"",billType:"",materialId:"",materialName:"",qty:"",status:"",pickMtrlStatus:"",stockInQty:"",bomId:""},chVersion:"",editable:!0},K=k([]);j(()=>{f()});function R(t){t.editable=!0}function q(){K.value.forEach(t=>{t.editable=!0})}const T=k(null);function B(){if(I)d.outsourcedOrder.data.unshift({...x}),I=!1;else return}function p(t){t.result.id?(d.update({id:t.result.id,billNo:t.result.billNo,billType:t.result.billType,materialId:t.result.materialId,materialName:t.result.materialName,qty:t.result.qty,status:t.result.status,pickMtrlStatus:t.result.pickMtrlStatus,stockInQty:t.result.stockInQty,bomId:t.result.bomId},4).then(s=>{console.log("产能修改成功")}).catch(s=>{f(),console.log(t.id),console.log("产能修改失败")}),t.editable=!1):(d.add({billNo:t.result.billNo,billType:t.result.billType,materialId:t.result.materialId,materialName:t.result.materialName,qty:t.result.qty,status:t.result.status,pickMtrlStatus:t.result.pickMtrlStatus,stockInQty:t.result.stockInQty,bomId:t.result.bomId},4).then(s=>{I=!0,s.code==200?console.log("产能添加成功"):C.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),f()}).catch(s=>{console.log(s),console.log("产能添加失败"),f()}),t.editable=!1)}function E(t){N.value=t,d.getAllPage(t,v.value,4).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}function O(){const t=[];K.value.forEach(s=>{t.push(s.result.id)}),C.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{d.deleteData(t,4).then(s=>{console.log("删除产能成功"),S({type:"success",message:"删除成功"}),f()}).catch(s=>{console.log(s),console.log("批量删除产能失败")})}).catch(()=>{S({type:"info",message:"取消删除"})})}function P(t){K.value=t}function f(){I=!0,d.getAllPage(N.value,v.value,4).then(t=>{S({type:"success",message:"刷新成功"}),T.value.clearSelection()}).catch(t=>{}),console.log("查询所有工序产能")}return(t,s)=>{const n=L,m=G,Q=H;return a(),r(i,null,[u(X,{class:"plan"}),o("div",Z,[o("div",{class:"head"},[o("button",{onClick:B},ee),o("button",{onClick:q},le),o("button",{onClick:O},oe),o("button",{onClick:f},ue),ne,de]),o("div",re,[u(Q,{data:U(d).outsourcedOrder.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:P,onRowDblclick:R,height:"62vh",ref_key:"myTable",ref:T},{default:c(()=>[u(n,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),u(n,{prop:"result.billNo",label:"单据编码",width:"120"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.billNo,"onUpdate:modelValue":l=>e.result.billNo=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.billNo),1)],64))]),_:1}),u(n,{prop:"result.billType",label:"单据类型",width:"120"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.billType,"onUpdate:modelValue":l=>e.result.billType=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.billType),1)],64))]),_:1}),u(n,{prop:"result.materialId",label:"物料编码",width:"130"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.materialId,"onUpdate:modelValue":l=>e.result.materialId=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.materialId),1)],64))]),_:1}),u(n,{prop:"result.materialName",label:"物料名称",width:"270"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.materialName,"onUpdate:modelValue":l=>e.result.materialName=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.materialName),1)],64))]),_:1}),u(n,{prop:"result.qty",label:"数量",width:"100"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.qty,"onUpdate:modelValue":l=>e.result.qty=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.qty),1)],64))]),_:1}),u(n,{prop:"result.status",label:"业务状态",width:"90"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.status,"onUpdate:modelValue":l=>e.result.status=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.status),1)],64))]),_:1}),u(n,{prop:"result.pickMtrlStatus",label:"领料状态",width:"90"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.pickMtrlStatus,"onUpdate:modelValue":l=>e.result.pickMtrlStatus=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.pickMtrlStatus),1)],64))]),_:1}),u(n,{prop:"result.stockInQty",label:"入库数量",width:"90"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.stockInQty,"onUpdate:modelValue":l=>e.result.stockInQty=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.stockInQty),1)],64))]),_:1}),u(n,{prop:"result.bomId",label:"BOM版本",width:"150"},{default:c(({row:e})=>[e.editable?(a(),y(m,{key:0,modelValue:e.result.bomId,"onUpdate:modelValue":l=>e.result.bomId=l,onKeyup:_(l=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[b(h(e.result.bomId),1)],64))]),_:1}),u(n,{prop:"chVersion",label:"版本号",width:"100"})]),_:1},8,["data"])]),o("div",ce,[u(Y,{total:U(d).outsourcedOrder.pages,onChangePage:E,onUpdateSize:M,totalRows:U(d).outsourcedOrder.total},null,8,["total","totalRows"])])])],64)}}},ke=$(ie,[["__scopeId","data-v-19809c4c"]]);export{ke as default};
