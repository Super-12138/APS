import{_ as Y,r as y,aJ as Z,q as w,s as ee,b as ae,v as oe,aK as U,c as i,e as d,d as t,h as r,f as C,F as u,a4 as K,o as n,i as p,j as x,k as m,t as g,a2 as le,p as te,l as ne,E as se}from"./index-ba92c6b8.js";import{E as ce,a as de}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{E as ie,a as re}from"./el-select-e5188bed.js";import{E as ue}from"./el-autocomplete-f373dd58.js";import{C as pe}from"./CommonPlan-b2bd4878.js";import{P as me}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const _=b=>(te("data-v-1a2e19c8"),b=b(),ne(),b),ge={class:"container"},_e=_(()=>t("span",{class:"first"},"新增",-1)),he=[_e],ye=_(()=>t("span",null,"修改",-1)),be=[ye],fe=_(()=>t("span",null,"删除",-1)),Pe=[fe],ve=_(()=>t("span",null,"刷新",-1)),ke=[ve],Ve=_(()=>t("span",null,"排序",-1)),Ce=[Ve],xe=_(()=>t("button",null,[t("span",null,"导入")],-1)),Ne=_(()=>t("button",null,[t("span",null,"导出")],-1)),Me={class:"main"},Te={class:"bottom"},Ue={__name:"processCapacity",setup(b){let N=y(1),f=y(20);const s=Z();w();const B=ee();function I(){s.getAllPackagingMethod().then(e=>{console.log("点开了包装方式的下拉框")}).catch(e=>{})}function A(e){f.value=e,s.getProcessCapacity(N.value,f.value).then(o=>{console.log("获取分页表格数据成功")}).catch(o=>{})}function D(){B.push({name:"moveData"})}const M=y([]),P=y([]),O=(e,o)=>{const c=e?M.value.filter(F(e)):M.value;o(c)},$=(e,o)=>{const c=e?P.value.filter(F(e)):P.value;o(c)},F=e=>o=>o.value.indexOf(e)!==-1,E=e=>{console.log(e,"item")};ae(()=>{s.getProcessNamePools().then(e=>{M.value=s.processNames.data.map(o=>({value:o.processName})),console.log("点开了工序名称的下拉框")}).catch(e=>{}),s.getAllProductFamily().then(e=>{P.value=s.productFamily.map(o=>({value:o})),console.log(P,"点开了产品族的下拉框")}).catch(e=>{})});let v=!0;const z={belongingProcess:"",productFamily:"",processNumber:"",processName:"",packagingMethod:"",standardTime:"",maxPersonnel:1,minPersonnel:1,editable:!0},T=y([]);oe(()=>{h()});function j(e){e.editable=!0}function q(){T.value.forEach(e=>{e.editable=!0})}const S=y(null);function J(){if(v)s.capacity.data.unshift({...z}),v=!1;else return}function k(e){console.log("修改数据",e),e.id?(s.addOrUpdateProcessCapacity({id:e.id,belongingProcess:e.belongingProcess,productFamily:e.productFamily,processNumber:e.processNumber,processName:e.processName,packagingMethod:e.packagingMethod,standardTime:e.standardTime,maxPersonnel:e.maxPersonnel,minPersonnel:e.minPersonnel}).then(o=>{console.log("产能修改成功")}).catch(o=>{h(),console.log(e.id),console.log("产能修改失败")}),e.editable=!1):(s.addOrUpdateProcessCapacity({belongingProcess:e.belongingProcess,productFamily:e.productFamily,processName:e.processName,packagingMethod:e.packagingMethod,standardTime:e.standardTime,maxPersonnel:e.maxPersonnel,minPersonnel:e.minPersonnel}).then(o=>{v=!0,o.code==200?console.log("产能添加成功"):K.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),h()}).catch(o=>{console.log(o),console.log("产能添加失败"),h()}),e.editable=!1)}function L(e){N.value=e,s.getProcessCapacity(e,f.value).then(o=>{console.log("获取分页表格数据成功")}).catch(o=>{})}function W(){const e=[];T.value.forEach(o=>{e.push(o.id)}),K.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.deleteProcessCapacity(e).then(o=>{console.log("删除产能成功"),U({type:"success",message:"删除成功"}),h()}).catch(o=>{console.log(o),console.log("批量删除产能失败")})}).catch(()=>{U({type:"info",message:"取消删除"})})}function G(e){T.value=e}function h(){v=!0,s.getProcessCapacity(N.value,f.value).then(e=>{S.value.clearSelection(),U({type:"success",message:"刷新成功"})}).catch(e=>{}),console.log("查询所有工序产能")}return(e,o)=>{const c=de,V=se,R=ue,H=re,Q=ie,X=ce;return n(),i(u,null,[d(pe,{class:"plan"}),t("div",ge,[t("div",{class:"head"},[t("button",{onClick:J},he),t("button",{onClick:q},be),t("button",{onClick:W},Pe),t("button",{onClick:h},ke),t("button",{onClick:D},Ce),xe,Ne]),t("div",Me,[d(X,{data:C(s).capacity.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:G,onRowDblclick:j,height:"62vh",ref_key:"myTable",ref:S},{default:r(()=>[d(c,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),d(c,{prop:"belongingProcess",label:"所属工序",width:"120"},{default:r(({row:a})=>[a.editable?(n(),p(V,{key:0,modelValue:a.belongingProcess,"onUpdate:modelValue":l=>a.belongingProcess=l,onKeyup:x(l=>k(a),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),i(u,{key:1},[m(g(a.belongingProcess),1)],64))]),_:1}),d(c,{prop:"productFamily",label:"产品族",width:"140"},{default:r(({row:a})=>[a.editable?(n(),p(R,{key:0,modelValue:a.productFamily,"onUpdate:modelValue":l=>a.productFamily=l,"fetch-suggestions":$,clearable:"",class:"inline-input w-50",placeholder:"Please Input",onSelect:E},null,8,["modelValue","onUpdate:modelValue"])):(n(),i(u,{key:1},[m(g(a.productFamily),1)],64))]),_:1}),d(c,{prop:"processNumber",label:"序号",width:"110"}),d(c,{prop:"processName",label:"工序名称"},{default:r(({row:a})=>[a.editable?(n(),p(R,{key:0,modelValue:a.processName,"onUpdate:modelValue":l=>a.processName=l,"fetch-suggestions":O,clearable:"",class:"inline-input w-50",placeholder:"Please Input",onSelect:E},null,8,["modelValue","onUpdate:modelValue"])):(n(),i(u,{key:1},[m(g(a.processName),1)],64))]),_:1}),d(c,{prop:"packagingMethod",label:"包装方式",width:"120"},{default:r(({row:a})=>[a.editable?(n(),p(Q,{key:0,modelValue:a.packagingMethod,"onUpdate:modelValue":l=>a.packagingMethod=l,class:"m-2",placeholder:"Select",onClick:I},{default:r(()=>[(n(!0),i(u,null,le(C(s).packages,l=>(n(),p(H,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(n(),i(u,{key:1},[m(g(a.packagingMethod),1)],64))]),_:1}),d(c,{prop:"standardTime",label:"标准工时",width:"120"},{default:r(({row:a})=>[a.editable?(n(),p(V,{key:0,modelValue:a.standardTime,"onUpdate:modelValue":l=>a.standardTime=l,onKeyup:x(l=>k(a),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),i(u,{key:1},[m(g(a.standardTime),1)],64))]),_:1}),d(c,{prop:"maxPersonnel",label:"人员Max",width:"120"},{default:r(({row:a})=>[a.editable?(n(),p(V,{key:0,modelValue:a.maxPersonnel,"onUpdate:modelValue":l=>a.maxPersonnel=l,onKeyup:x(l=>k(a),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),i(u,{key:1},[m(g(a.maxPersonnel),1)],64))]),_:1}),d(c,{prop:"minPersonnel",label:"人员Min",width:"120"},{default:r(({row:a})=>[a.editable?(n(),p(V,{key:0,modelValue:a.minPersonnel,"onUpdate:modelValue":l=>a.minPersonnel=l,onKeyup:x(l=>k(a),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),i(u,{key:1},[m(g(a.minPersonnel),1)],64))]),_:1})]),_:1},8,["data"])]),t("div",Te,[d(me,{total:C(s).capacity.totalPages,onChangePage:L,onUpdateSize:A,totalRows:C(s).capacity.total},null,8,["total","totalRows"])])])],64)}}},Oe=Y(Ue,[["__scopeId","data-v-1a2e19c8"]]);export{Oe as default};
