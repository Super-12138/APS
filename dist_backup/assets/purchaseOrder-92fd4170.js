import{_ as $,bn as M,r as d,aJ as z,bm as F,q as j,s as q,v as J,aK as C,c,e as r,d as l,h as m,f as x,F as p,a4 as K,o as n,i as b,j as v,k as f,t as g,p as W,l as G,E as H}from"./index-ba92c6b8.js";import{E as L,a as X}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as Y}from"./CommonPlan-b2bd4878.js";import{P as Z}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const _=V=>(W("data-v-221a93db"),V=V(),G(),V),w={class:"container"},ee=_(()=>l("span",{class:"first"},"新增",-1)),te=[ee],le=_(()=>l("span",null,"修改",-1)),ae=[le],oe=_(()=>l("span",null,"删除",-1)),ne=[oe],se=_(()=>l("span",null,"刷新",-1)),re=[se],ue=_(()=>l("button",null,[l("span",null,"导入")],-1)),ie=_(()=>l("button",null,[l("span",null,"导出")],-1)),de={class:"main"},ce={class:"bottom"},me={__name:"purchaseOrder",setup(V){M();let R=d(1),k=d(20);z();const s=F();j(),q();function U(e){k.value=e,s.getAllPage(R.value,k.value,7).then(a=>{console.log("获取分页表格数据成功")}).catch(a=>{})}d([]),d([]);let N=!0;const S={result:{billNo:"",materialId:"",materialName:"",remainReceiveQty:"",deliveryDate:""},chVersion:"",editable:!0},I=d([]);J(()=>{i()});function E(e){e.editable=!0}function B(){I.value.forEach(e=>{e.editable=!0})}const D=d(null);function P(){if(N)s.purchaseOrder.data.unshift({...S}),N=!1;else return}function h(e){e.result.id?(s.update({id:e.result.id,billNo:e.result.billNo,materialId:e.result.materialId,materialName:e.result.materialName,remainReceiveQty:e.result.remainReceiveQty,deliveryDate:e.result.deliveryDate},7).then(a=>{console.log("产能修改成功")}).catch(a=>{i(),console.log(e.id),console.log("产能修改失败")}),e.editable=!1):(s.add({billNo:e.result.billNo,materialId:e.result.materialId,materialName:e.result.materialName,remainReceiveQty:e.result.remainReceiveQty,deliveryDate:e.result.deliveryDate},7).then(a=>{N=!0,a.code==200?console.log("产能添加成功"):K.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),i()}).catch(a=>{console.log(a),console.log("产能添加失败"),i()}),e.editable=!1)}function Q(e){R.value=e,s.getAllPage(e,k.value,7).then(a=>{console.log("获取分页表格数据成功")}).catch(a=>{})}function O(){const e=[];I.value.forEach(a=>{e.push(a.result.id)}),K.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.deleteData(e,7).then(a=>{console.log("删除产能成功"),C({type:"success",message:"删除成功"}),i()}).catch(a=>{console.log(a),console.log("批量删除产能失败")})}).catch(()=>{C({type:"info",message:"取消删除"})})}function T(e){I.value=e}function i(){N=!0,s.getAllPage(R.value,k.value,7).then(e=>{C({type:"success",message:"刷新成功"}),D.value.clearSelection()}).catch(e=>{}),console.log("查询所有工序产能")}return(e,a)=>{const u=X,y=H,A=L;return n(),c(p,null,[r(Y,{class:"plan"}),l("div",w,[l("div",{class:"head"},[l("button",{onClick:P},te),l("button",{onClick:B},ae),l("button",{onClick:O},ne),l("button",{onClick:i},re),ue,ie]),l("div",de,[r(A,{data:x(s).purchaseOrder.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:T,onRowDblclick:E,height:"62vh",ref_key:"myTable",ref:D},{default:m(()=>[r(u,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),r(u,{prop:"result.billNo",label:"单据编号",width:"180"},{default:m(({row:t})=>[t.editable?(n(),b(y,{key:0,modelValue:t.result.billNo,"onUpdate:modelValue":o=>t.result.billNo=o,onKeyup:v(o=>h(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),c(p,{key:1},[f(g(t.result.billNo),1)],64))]),_:1}),r(u,{prop:"result.materialId",label:"物料编号",width:"180"},{default:m(({row:t})=>[t.editable?(n(),b(y,{key:0,modelValue:t.result.materialId,"onUpdate:modelValue":o=>t.result.materialId=o,onKeyup:v(o=>h(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),c(p,{key:1},[f(g(t.result.materialId),1)],64))]),_:1}),r(u,{prop:"result.materialName",label:"物料名称"},{default:m(({row:t})=>[t.editable?(n(),b(y,{key:0,modelValue:t.result.materialName,"onUpdate:modelValue":o=>t.result.materialName=o,onKeyup:v(o=>h(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),c(p,{key:1},[f(g(t.result.materialName),1)],64))]),_:1}),r(u,{prop:"result.remainReceiveQty",label:"剩余收料数量",width:"180"},{default:m(({row:t})=>[t.editable?(n(),b(y,{key:0,modelValue:t.result.remainReceiveQty,"onUpdate:modelValue":o=>t.result.remainReceiveQty=o,onKeyup:v(o=>h(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),c(p,{key:1},[f(g(t.result.remainReceiveQty),1)],64))]),_:1}),r(u,{prop:"result.deliveryDate",label:"交货日期",width:"180"},{default:m(({row:t})=>[t.editable?(n(),b(y,{key:0,modelValue:t.result.deliveryDate,"onUpdate:modelValue":o=>t.result.deliveryDate=o,onKeyup:v(o=>h(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),c(p,{key:1},[f(g(t.result.deliveryDate),1)],64))]),_:1}),r(u,{prop:"chVersion",label:"版本号",width:"100"})]),_:1},8,["data"])]),l("div",ce,[r(Z,{total:x(s).purchaseOrder.pages,onChangePage:Q,onUpdateSize:U,totalRows:x(s).purchaseOrder.total},null,8,["total","totalRows"])])])],64)}}},ge=$(me,[["__scopeId","data-v-221a93db"]]);export{ge as default};
