import{_ as $,r as i,aJ as M,bm as z,q as F,s as j,v as q,aK as D,c as d,e as u,d as l,h as p,f as K,F as m,a4 as R,o as n,i as f,j as b,k as g,t as v,p as J,l as W,E as G}from"./index-ba92c6b8.js";import{E as H,a as O}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as X}from"./CommonPlan-b2bd4878.js";import{P as Y}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const _=k=>(J("data-v-f6b0b95e"),k=k(),W(),k),Z={class:"container"},w=_(()=>l("span",{class:"first"},"新增",-1)),ee=[w],te=_(()=>l("span",null,"修改",-1)),le=[te],ae=_(()=>l("span",null,"删除",-1)),oe=[ae],ne=_(()=>l("span",null,"刷新",-1)),se=[ne],ue=_(()=>l("button",null,[l("span",null,"导入")],-1)),ce=_(()=>l("button",null,[l("span",null,"导出")],-1)),re={class:"main"},ie={class:"bottom"},de={__name:"inventoryLock",setup(k){let I=i(1),V=i(20);M();const s=z();F(),j();function U(e){V.value=e,s.getAllPage(I.value,V.value,9).then(a=>{console.log("获取分页表格数据成功")}).catch(a=>{})}i([]),i([]);let x=!0;const E={result:{materialId:"",materialName:"",expiryDate:"",lockQty:null,lot:""},chVersion:"",editable:!0},C=i([]);q(()=>{r()});function S(e){e.editable=!0}function B(){C.value.forEach(e=>{e.editable=!0})}const N=i(null);function P(){if(x)s.inventoryLock.data.unshift({...E}),x=!1;else return}function y(e){e.result.id?(s.update({id:e.result.id,materialId:e.result.materialId,materialName:e.result.materialName,expiryDate:e.result.expiryDate,lockQty:e.result.lockQty,lot:e.result.lot},9).then(a=>{console.log("产能修改成功")}).catch(a=>{r(),console.log(e.id),console.log("产能修改失败")}),e.editable=!1):(s.add({materialId:e.result.materialId,materialName:e.result.materialName,expiryDate:e.result.expiryDate,lockQty:e.result.lockQty,lot:e.result.lot},9).then(a=>{x=!0,a.code==200?console.log("产能添加成功"):R.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),r()}).catch(a=>{console.log(a),console.log("产能添加失败"),r()}),e.editable=!1)}function Q(e){I.value=e,s.getAllPage(e,V.value,9).then(a=>{console.log("获取分页表格数据成功")}).catch(a=>{})}function L(){const e=[];C.value.forEach(a=>{e.push(a.result.id)}),R.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{s.deleteData(e,9).then(a=>{console.log("删除产能成功"),D({type:"success",message:"删除成功"}),r()}).catch(a=>{console.log(a),console.log("批量删除产能失败")})}).catch(()=>{D({type:"info",message:"取消删除"})})}function T(e){C.value=e}function r(){x=!0,s.getAllPage(I.value,V.value,9).then(e=>{D({type:"success",message:"刷新成功"}),N.value.clearSelection()}).catch(e=>{}),console.log("查询所有工序产能")}return(e,a)=>{const c=O,h=G,A=H;return n(),d(m,null,[u(X,{class:"plan"}),l("div",Z,[l("div",{class:"head"},[l("button",{onClick:P},ee),l("button",{onClick:B},le),l("button",{onClick:L},oe),l("button",{onClick:r},se),ue,ce]),l("div",re,[u(A,{data:K(s).inventoryLock.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:T,onRowDblclick:S,height:"62vh",ref_key:"myTable",ref:N},{default:p(()=>[u(c,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),u(c,{prop:"result.materialId",label:"物料编码",width:"200"},{default:p(({row:t})=>[t.editable?(n(),f(h,{key:0,modelValue:t.result.materialId,"onUpdate:modelValue":o=>t.result.materialId=o,onKeyup:b(o=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),d(m,{key:1},[g(v(t.result.materialId),1)],64))]),_:1}),u(c,{prop:"result.materialName",label:"物料名称"},{default:p(({row:t})=>[t.editable?(n(),f(h,{key:0,modelValue:t.result.materialName,"onUpdate:modelValue":o=>t.result.materialName=o,onKeyup:b(o=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),d(m,{key:1},[g(v(t.result.materialName),1)],64))]),_:1}),u(c,{prop:"result.expiryDate",label:"到期日",width:"200"},{default:p(({row:t})=>[t.editable?(n(),f(h,{key:0,modelValue:t.result.expiryDate,"onUpdate:modelValue":o=>t.result.expiryDate=o,onKeyup:b(o=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),d(m,{key:1},[g(v(t.result.expiryDate),1)],64))]),_:1}),u(c,{prop:"result.lockQty",label:"锁库数量",width:"150"},{default:p(({row:t})=>[t.editable?(n(),f(h,{key:0,modelValue:t.result.lockQty,"onUpdate:modelValue":o=>t.result.lockQty=o,onKeyup:b(o=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),d(m,{key:1},[g(v(t.result.lockQty),1)],64))]),_:1}),u(c,{prop:"result.lot",label:"批号",width:"150"},{default:p(({row:t})=>[t.editable?(n(),f(h,{key:0,modelValue:t.result.lot,"onUpdate:modelValue":o=>t.result.lot=o,onKeyup:b(o=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(n(),d(m,{key:1},[g(v(t.result.lot),1)],64))]),_:1}),u(c,{prop:"chVersion",label:"版本号",width:"150"})]),_:1},8,["data"])]),l("div",ie,[u(Y,{total:K(s).inventoryLock.pages,onChangePage:Q,onUpdateSize:U,totalRows:K(s).inventoryLock.total},null,8,["total","totalRows"])])])],64)}}},ge=$(de,[["__scopeId","data-v-f6b0b95e"]]);export{ge as default};
