import{_ as A,r as b,bm as z,q as F,s as j,v as q,aK as I,c as d,e as u,d as o,h as r,f as K,F as i,a4 as B,o as a,i as y,j as _,k as h,t as f,p as W,l as G,E as H}from"./index-ba92c6b8.js";import{E as J,a as L}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as O}from"./CommonPlan-b2bd4878.js";import{P as X}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const V=k=>(W("data-v-640e7e42"),k=k(),G(),k),Y={class:"container"},Z=V(()=>o("span",{class:"first"},"新增",-1)),w=[Z],ee=V(()=>o("span",null,"修改",-1)),te=[ee],le=V(()=>o("span",null,"删除",-1)),ae=[le],oe=V(()=>o("span",null,"刷新",-1)),ne=[oe],ue=V(()=>o("button",null,[o("span",null,"导入")],-1)),se=V(()=>o("button",null,[o("span",null,"导出")],-1)),de={class:"main"},re={class:"bottom"},ie={__name:"productionMaterial",setup(k){let N=b(1),v=b(20);const c=z();F(),j();function T(t){v.value=t,c.getAllPage(N.value,v.value,3).then(n=>{console.log("获取分页表格数据成功")}).catch(n=>{})}b([]),b([]);let Q=!0;const C={result:{materialId:"",materialName:"",moBillNo:"",materialId2:"",materialName2:"",materialType:"",mustQty:"",pickedQty:"",goodReturnQty:"",processDefectReturnQty:""},chVersion:"",editable:!0},R=b([]);q(()=>{g()});function x(t){t.editable=!0}function D(){R.value.forEach(t=>{t.editable=!0})}const U=b(null);function M(){if(Q)c.productionMaterial.data.unshift({...C}),Q=!1;else return}function m(t){t.result.id?(c.update({id:t.result.id,materialId:t.result.materialId,materialName:t.result.materialName,moBillNo:t.result.moBillNo,materialId2:t.result.materialId2,materialName2:t.result.materialName2,materialType:t.result.materialType,mustQty:t.result.mustQty,pickedQty:t.result.pickedQty,goodReturnQty:t.result.goodReturnQty,processDefectReturnQty:t.result.processDefectReturnQty},3).then(n=>{console.log("产能修改成功")}).catch(n=>{g(),console.log(t.id),console.log("产能修改失败")}),t.editable=!1):(c.add({materialId:t.result.materialId,materialName:t.result.materialName,moBillNo:t.result.moBillNo,materialId2:t.result.materialId2,materialName2:t.result.materialName2,materialType:t.result.materialType,mustQty:t.result.mustQty,pickedQty:t.result.pickedQty,goodReturnQty:t.result.goodReturnQty,processDefectReturnQty:t.result.processDefectReturnQty},3).then(n=>{Q=!0,n.code==200?console.log("产能添加成功"):B.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),g()}).catch(n=>{console.log(n),console.log("产能添加失败"),g()}),t.editable=!1)}function E(t){N.value=t,c.getAllPage(t,v.value,3).then(n=>{console.log("获取分页表格数据成功")}).catch(n=>{})}function S(){const t=[];R.value.forEach(n=>{t.push(n.result.id)}),B.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.deleteData(t,3).then(n=>{console.log("删除产能成功"),I({type:"success",message:"删除成功"}),g()}).catch(n=>{console.log(n),console.log("批量删除产能失败")})}).catch(()=>{I({type:"info",message:"取消删除"})})}function $(t){R.value=t}function g(){Q=!0,c.getAllPage(N.value,v.value,3).then(t=>{I({type:"success",message:"刷新成功"}),U.value.clearSelection()}).catch(t=>{}),console.log("查询所有工序产能")}return(t,n)=>{const s=L,p=H,P=J;return a(),d(i,null,[u(O,{class:"plan"}),o("div",Y,[o("div",{class:"head"},[o("button",{onClick:M},w),o("button",{onClick:D},te),o("button",{onClick:S},ae),o("button",{onClick:g},ne),ue,se]),o("div",de,[u(P,{data:K(c).productionMaterial.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:$,onRowDblclick:x,height:"62vh",ref_key:"myTable",ref:U},{default:r(()=>[u(s,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),u(s,{prop:"result.materialId",label:"产品编码",width:"110"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialId,"onUpdate:modelValue":l=>e.result.materialId=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialId),1)],64))]),_:1}),u(s,{prop:"result.materialName",label:"产品名称",width:"220"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialName,"onUpdate:modelValue":l=>e.result.materialName=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialName),1)],64))]),_:1}),u(s,{prop:"result.moBillNo",label:"生产订单编号",width:"150"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.moBillNo,"onUpdate:modelValue":l=>e.result.moBillNo=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.moBillNo),1)],64))]),_:1}),u(s,{prop:"result.materialId2",label:"子项物料编码",width:"130"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialId2,"onUpdate:modelValue":l=>e.result.materialId2=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialId2),1)],64))]),_:1}),u(s,{prop:"result.materialName2",label:"子项物料名称",width:"230"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialName2,"onUpdate:modelValue":l=>e.result.materialName2=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialName2),1)],64))]),_:1}),u(s,{prop:"result.materialType",label:"子项类型",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialType,"onUpdate:modelValue":l=>e.result.materialType=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialType),1)],64))]),_:1}),u(s,{prop:"result.mustQty",label:"应发数量",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.mustQty,"onUpdate:modelValue":l=>e.result.mustQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.mustQty),1)],64))]),_:1}),u(s,{prop:"result.pickedQty",label:"已领数量",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.pickedQty,"onUpdate:modelValue":l=>e.result.pickedQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.pickedQty),1)],64))]),_:1}),u(s,{prop:"result.goodReturnQty",label:"良品退料数量"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.goodReturnQty,"onUpdate:modelValue":l=>e.result.goodReturnQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.goodReturnQty),1)],64))]),_:1}),u(s,{prop:"result.processDefectReturnQty",label:"作业不良退料数量"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.processDefectReturnQty,"onUpdate:modelValue":l=>e.result.processDefectReturnQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.processDefectReturnQty),1)],64))]),_:1}),u(s,{prop:"chVersion",label:"版本号",width:"120"})]),_:1},8,["data"])]),o("div",re,[u(X,{total:K(c).productionMaterial.pages,onChangePage:E,onUpdateSize:T,totalRows:K(c).productionMaterial.total},null,8,["total","totalRows"])])])],64)}}},ge=A(ie,[["__scopeId","data-v-640e7e42"]]);export{ge as default};
