import{_ as U,m as I,q as B,s as A,r as D,w as M,v as $,c as r,e as d,d as l,h as _,f as F,F as m,o as c,i as b,j as g,k as v,t as y,p as L,l as j,E as q}from"./index-ba92c6b8.js";import{E as P,a as W}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as z}from"./CommonPlan-b2bd4878.js";import"./isEqual-3fc68a3b.js";const p=h=>(L("data-v-90ccd82b"),h=h(),j(),h),G={class:"container"},H=p(()=>l("span",{class:"first"},"新增",-1)),J=[H],O=p(()=>l("span",null,"修改",-1)),Q=[O],X=p(()=>l("span",null,"删除",-1)),Y=[X],Z=p(()=>l("span",null,"刷新",-1)),w=[Z],ee=p(()=>l("button",null,[l("span",null,"导入")],-1)),oe=p(()=>l("button",null,[l("span",null,"导出")],-1)),le={class:"main"},te={__name:"list",setup(h){const t=I(),V=B();A();let k=!0;const R={id:"",roleName:"",roleCode:"",description:"",dataScope:"",createTime:"",updateTime:"",editable:!0},i=D([]);M(()=>V.path,()=>{C()}),$(()=>{C()});function S(e){e.editable=!0}function x(){i.value.forEach(e=>{e.editable=!0})}function N(){if(k)t.roles.push({...R}),k=!1;else return}function f(e){e.id<=t.roles.length&&e.id?(t.updateRole(e.id,e.roleName,e.roleCode,e.description,e.dataScope).then(n=>{console.log("角色修改成功")}).catch(n=>{console.log(e.id),console.log("vue角色修改失败")}),e.editable=!1):(t.addRole(e.roleName,e.roleCode,e.description,e.dataScope).then(n=>{k=!0,console.log("角色添加成功");const a=t.roles.findIndex(u=>u===e);a!==-1&&t.roles.splice(a,1,n),t.roles.splice(a,1)}).catch(n=>{console.log(n),console.log("vue角色添加失败")}),e.createTime=new Date().toLocaleString(),e.updateTime=new Date().toLocaleString(),e.id=t.roles.length,e.editable=!1)}function K(){if(i.value.length>1){const e=[];i.value.forEach(n=>{e.push(n.id)}),t.removeMoreRole(e).then(n=>{console.log("vue批量角色删除成功")}).catch(n=>{console.log(n),console.log("vue批量角色删除失败")})}else i.value.length==1&&t.removeRole(i.value[0].id).then(e=>{console.log("vue角色删除成功")}).catch(e=>{console.log(e),console.log("vue角色删除失败")})}function T(e){i.value=e}function C(){t.findAll().then(e=>{console.log("查询所有角色",e)})}return(e,n)=>{const a=W,u=q,E=P;return c(),r(m,null,[d(z,{class:"plan"}),l("div",G,[l("div",{class:"head"},[l("button",{onClick:N},J),l("button",{onClick:x},Q),l("button",{onClick:K},Y),l("button",{onClick:C},w),ee,oe]),l("div",le,[d(E,{data:F(t).roles,border:"",style:{width:"100%"},"cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:T,onRowDblclick:S},{default:_(()=>[d(a,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),d(a,{prop:"id",label:"序号",width:"127"}),d(a,{prop:"roleName",label:"角色名称",width:"150"},{default:_(({row:o})=>[o.editable?(c(),b(u,{key:0,modelValue:o.roleName,"onUpdate:modelValue":s=>o.roleName=s,onKeyup:g(s=>f(o),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(c(),r(m,{key:1},[v(y(o.roleName),1)],64))]),_:1}),d(a,{prop:"roleCode",label:"角色码",width:"150"},{default:_(({row:o})=>[o.editable?(c(),b(u,{key:0,modelValue:o.roleCode,"onUpdate:modelValue":s=>o.roleCode=s,onKeyup:g(s=>f(o),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(c(),r(m,{key:1},[v(y(o.roleCode),1)],64))]),_:1}),d(a,{prop:"description",label:"描述",width:"150"},{default:_(({row:o})=>[o.editable?(c(),b(u,{key:0,modelValue:o.description,"onUpdate:modelValue":s=>o.description=s,onKeyup:g(s=>f(o),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(c(),r(m,{key:1},[v(y(o.description),1)],64))]),_:1}),d(a,{prop:"dataScope",label:"数据范围",width:"150"},{default:_(({row:o})=>[o.editable?(c(),b(u,{key:0,modelValue:o.dataScope,"onUpdate:modelValue":s=>o.dataScope=s,onKeyup:g(s=>f(o),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(c(),r(m,{key:1},[v(y(o.dataScope),1)],64))]),_:1}),d(a,{prop:"createTime",label:"创建时间",width:"250"}),d(a,{prop:"updateTime",label:"更新时间",width:"250"})]),_:1},8,["data"])])])],64)}}},ue=U(te,[["__scopeId","data-v-90ccd82b"]]);export{ue as default};
