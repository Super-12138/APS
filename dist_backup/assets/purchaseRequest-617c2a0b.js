import{_ as M,r as i,aJ as $,bm as z,q as F,s as j,v as J,aK as C,c as m,e as n,d as a,h as p,f as x,F as _,a4 as N,o as u,i as v,j as V,k,t as R,p as W,l as G,E as H}from"./index-ba92c6b8.js";import{E as L,a as O}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as X}from"./CommonPlan-b2bd4878.js";import{P as Y}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const d=h=>(W("data-v-8d09ca92"),h=h(),G(),h),Z={class:"container"},w=d(()=>a("span",{class:"first"},"新增",-1)),ee=[w],te=d(()=>a("span",null,"修改",-1)),ae=[te],le=d(()=>a("span",null,"删除",-1)),se=[le],oe=d(()=>a("span",null,"刷新",-1)),ne=[oe],ue=d(()=>a("button",null,[a("span",null,"导入")],-1)),re=d(()=>a("button",null,[a("span",null,"导出")],-1)),ce={class:"main"},ie={class:"bottom"},de={__name:"purchaseRequest",setup(h){let U=i(1),b=i(20);$();const o=z();F(),j();function E(e){b.value=e,o.getAllPage(U.value,b.value,6).then(l=>{console.log("获取分页表格数据成功")}).catch(l=>{})}i([]),i([]);let f=!0;const K={result:{materialId:"",materialName:"",baseUnitQty:"",arrivalDate:""},chVersion:"",editable:!0},I=i([]);J(()=>{r()});function S(e){e.editable=!0}function q(){I.value.forEach(e=>{e.editable=!0})}const D=i(null);function B(){if(f)o.purchaseRequest.data.unshift({...K}),f=!1;else return}function y(e){e.result.id?(o.update({id:e.result.id,materialId:e.result.materialId,materialName:e.result.materialName,baseUnitQty:e.result.baseUnitQty,arrivalDate:e.result.arrivalDate},6).then(l=>{console.log("产能修改成功")}).catch(l=>{r(),console.log(e.id),console.log("产能修改失败")}),e.editable=!1):(o.add({materialId:e.result.materialId,materialName:e.result.materialName,baseUnitQty:e.result.baseUnitQty,arrivalDate:e.result.arrivalDate},6).then(l=>{f=!0,l.code==200?console.log("产能添加成功"):N.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),r()}).catch(l=>{console.log(l),console.log("产能添加失败"),r()}),e.editable=!1)}function P(e){U.value=e,o.getAllPage(e,b.value,6).then(l=>{console.log("获取分页表格数据成功")}).catch(l=>{})}function Q(){const e=[];I.value.forEach(l=>{e.push(l.result.id)}),N.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.deleteData(e,6).then(l=>{console.log("删除产能成功"),C({type:"success",message:"删除成功"}),r()}).catch(l=>{console.log(l),console.log("批量删除产能失败")})}).catch(()=>{C({type:"info",message:"取消删除"})})}function T(e){I.value=e}function r(){f=!0,o.getAllPage(U.value,b.value,6).then(e=>{C({type:"success",message:"刷新成功"}),D.value.clearSelection()}).catch(e=>{}),console.log("查询所有工序产能")}return(e,l)=>{const c=O,g=H,A=L;return u(),m(_,null,[n(X,{class:"plan"}),a("div",Z,[a("div",{class:"head"},[a("button",{onClick:B},ee),a("button",{onClick:q},ae),a("button",{onClick:Q},se),a("button",{onClick:r},ne),ue,re]),a("div",ce,[n(A,{data:x(o).purchaseRequest.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:T,onRowDblclick:S,height:"62vh",ref_key:"myTable",ref:D},{default:p(()=>[n(c,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),n(c,{prop:"result.materialId",label:"物料编码",width:"150"},{default:p(({row:t})=>[t.editable?(u(),v(g,{key:0,modelValue:t.result.materialId,"onUpdate:modelValue":s=>t.result.materialId=s,onKeyup:V(s=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(u(),m(_,{key:1},[k(R(t.result.materialId),1)],64))]),_:1}),n(c,{prop:"result.materialName",label:"物料名称"},{default:p(({row:t})=>[t.editable?(u(),v(g,{key:0,modelValue:t.result.materialName,"onUpdate:modelValue":s=>t.result.materialName=s,onKeyup:V(s=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(u(),m(_,{key:1},[k(R(t.result.materialName),1)],64))]),_:1}),n(c,{prop:"result.baseUnitQty",label:"批准数量",width:"150"},{default:p(({row:t})=>[t.editable?(u(),v(g,{key:0,modelValue:t.result.baseUnitQty,"onUpdate:modelValue":s=>t.result.baseUnitQty=s,onKeyup:V(s=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(u(),m(_,{key:1},[k(R(t.result.baseUnitQty),1)],64))]),_:1}),n(c,{prop:"result.arrivalDate",label:"到货日期",width:"180"},{default:p(({row:t})=>[t.editable?(u(),v(g,{key:0,modelValue:t.result.arrivalDate,"onUpdate:modelValue":s=>t.result.arrivalDate=s,onKeyup:V(s=>y(t),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(u(),m(_,{key:1},[k(R(t.result.arrivalDate),1)],64))]),_:1}),n(c,{prop:"chVersion",label:"版本号",width:"100"})]),_:1},8,["data"])]),a("div",ie,[n(Y,{total:x(o).purchaseRequest.pages,onChangePage:P,onUpdateSize:E,totalRows:x(o).purchaseRequest.total},null,8,["total","totalRows"])])])],64)}}},ge=M(de,[["__scopeId","data-v-8d09ca92"]]);export{ge as default};
