import{_ as A,r as f,aJ as M,bm as z,q as D,s as F,v as j,aK as S,c as r,e as o,d as n,h as d,f as B,F as i,a4 as T,o as a,i as c,j as y,k as h,t as _,p as q,l as J,E as O}from"./index-ba92c6b8.js";import{E as W,a as H}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as X}from"./CommonPlan-b2bd4878.js";import{P as Y}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const g=v=>(q("data-v-6c90b3f8"),v=v(),J(),v),Z={class:"container"},w=g(()=>n("span",{class:"first"},"新增",-1)),ee=[w],le=g(()=>n("span",null,"修改",-1)),te=[le],ae=g(()=>n("span",null,"删除",-1)),oe=[ae],ue=g(()=>n("span",null,"刷新",-1)),ne=[ue],se=g(()=>n("button",null,[n("span",null,"导入")],-1)),re=g(()=>n("button",null,[n("span",null,"导出")],-1)),de={class:"main"},ie={class:"bottom"},pe={__name:"materialBom",setup(v){let K=f(1),k=f(20);M();const V=z();D(),F();function x(l){k.value=l,V.getAllPage(K.value,k.value,10).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}f([]),f([]);let C=!0;const N={result:{materialId:"",materialName:"",documentStatus:"",materialIdChild:"",materialNameChild:"",numerator:"",denominator:"",fixScrapQtyLot:"",scrapRate:"",materialType:"",replaceType:"",replaceGroupBop:"",process:"",bomVersion:""},chVersion:"",editable:!0},U=f([]);j(()=>{b()});function R(l){l.editable=!0}function $(){U.value.forEach(l=>{l.editable=!0})}const I=f(null);function E(){if(C)V.materialBom.data.unshift({...N}),C=!1;else return}function p(l){l.result.id?(V.update({id:l.result.id,materialId:l.result.materialId,materialName:l.result.materialName,documentStatus:l.result.documentStatus,materialIdChild:l.result.materialIdChild,materialNameChild:l.result.materialNameChild,numerator:l.result.numerator,denominator:l.result.denominator,fixScrapQtyLot:l.result.fixScrapQtyLot,scrapRate:l.result.scrapRate,materialType:l.result.materialType,replaceType:l.result.replaceType,replaceGroupBop:l.result.replaceGroupBop,process:l.result.process,bomVersion:l.result.bomVersion},10).then(s=>{console.log("产能修改成功")}).catch(s=>{b(),console.log(l.id),console.log("产能修改失败")}),l.editable=!1):(V.add({materialId:l.result.materialId,materialName:l.result.materialName,documentStatus:l.result.documentStatus,materialIdChild:l.result.materialIdChild,materialNameChild:l.result.materialNameChild,numerator:l.result.numerator,denominator:l.result.denominator,fixScrapQtyLot:l.result.fixScrapQtyLot,scrapRate:l.result.scrapRate,materialType:l.result.materialType,replaceType:l.result.replaceType,replaceGroupBop:l.result.replaceGroupBop,process:l.result.process,bomVersion:l.result.bomVersion},10).then(s=>{C=!0,s.code==200?console.log("产能添加成功"):T.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),b()}).catch(s=>{console.log(s),console.log("产能添加失败"),b()}),l.editable=!1)}function G(l){K.value=l,V.getAllPage(l,k.value,10).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}function L(){const l=[];U.value.forEach(s=>{l.push(s.result.id)}),T.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{V.deleteData(l,10).then(s=>{console.log("删除产能成功"),S({type:"success",message:"删除成功"}),b()}).catch(s=>{console.log(s),console.log("批量删除产能失败")})}).catch(()=>{S({type:"info",message:"取消删除"})})}function P(l){U.value=l}function b(){C=!0,V.getAllPage(K.value,k.value,10).then(l=>{S({type:"success",message:"刷新成功"}),I.value.clearSelection()}).catch(l=>{}),console.log("查询所有工序产能")}return(l,s)=>{const u=H,m=O,Q=W;return a(),r(i,null,[o(X,{class:"plan"}),n("div",Z,[n("div",{class:"head"},[n("button",{onClick:E},ee),n("button",{onClick:$},te),n("button",{onClick:L},oe),n("button",{onClick:b},ne),se,re]),n("div",de,[o(Q,{data:B(V).materialBom.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:P,onRowDblclick:R,height:"62vh",ref_key:"myTable",ref:I},{default:d(()=>[o(u,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),o(u,{prop:"result.materialId",label:"父项物料编码",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.materialId,"onUpdate:modelValue":t=>e.result.materialId=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.materialId),1)],64))]),_:1}),o(u,{prop:"result.materialName",label:"父项物料名称",width:"200"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.materialName,"onUpdate:modelValue":t=>e.result.materialName=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.materialName),1)],64))]),_:1}),o(u,{prop:"result.documentStatus",label:"数据状态",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.documentStatus,"onUpdate:modelValue":t=>e.result.documentStatus=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.documentStatus),1)],64))]),_:1}),o(u,{prop:"result.materialIdChild",label:"子项物料编码",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.materialIdChild,"onUpdate:modelValue":t=>e.result.materialIdChild=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.materialIdChild),1)],64))]),_:1}),o(u,{prop:"result.materialNameChild",label:"子项物料名称",width:"200"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.materialNameChild,"onUpdate:modelValue":t=>e.result.materialNameChild=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.materialNameChild),1)],64))]),_:1}),o(u,{prop:"result.numerator",label:"用量：分子",width:"100"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.numerator,"onUpdate:modelValue":t=>e.result.numerator=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.numerator),1)],64))]),_:1}),o(u,{prop:"result.denominator",label:"用量：分母",width:"100"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.denominator,"onUpdate:modelValue":t=>e.result.denominator=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.denominator),1)],64))]),_:1}),o(u,{prop:"result.fixScrapQtyLot",label:"固定损耗",width:"90"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.fixScrapQtyLot,"onUpdate:modelValue":t=>e.result.fixScrapQtyLot=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.fixScrapQtyLot),1)],64))]),_:1}),o(u,{prop:"result.scrapRate",label:"变动损耗率%",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.scrapRate,"onUpdate:modelValue":t=>e.result.scrapRate=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.scrapRate),1)],64))]),_:1}),o(u,{prop:"result.materialType",label:"子项类型",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.materialType,"onUpdate:modelValue":t=>e.result.materialType=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.materialType),1)],64))]),_:1}),o(u,{prop:"result.replaceType",label:"替代方案",width:"110"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.replaceType,"onUpdate:modelValue":t=>e.result.replaceType=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.replaceType),1)],64))]),_:1}),o(u,{prop:"result.replaceGroupBop",label:"项次",width:"80"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.replaceGroupBop,"onUpdate:modelValue":t=>e.result.replaceGroupBop=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.replaceGroupBop),1)],64))]),_:1}),o(u,{prop:"result.process",label:"工序",width:"80"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.process,"onUpdate:modelValue":t=>e.result.process=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.process),1)],64))]),_:1}),o(u,{prop:"result.bomVersion",label:"BOM版本",width:"150"},{default:d(({row:e})=>[e.editable?(a(),c(m,{key:0,modelValue:e.result.bomVersion,"onUpdate:modelValue":t=>e.result.bomVersion=t,onKeyup:y(t=>p(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),r(i,{key:1},[h(_(e.result.bomVersion),1)],64))]),_:1}),o(u,{prop:"chVersion",label:"版本号",width:"100"})]),_:1},8,["data"])]),n("div",ie,[o(Y,{total:B(V).materialBom.pages,onChangePage:G,onUpdateSize:x,totalRows:B(V).materialBom.total},null,8,["total","totalRows"])])])],64)}}},fe=A(pe,[["__scopeId","data-v-6c90b3f8"]]);export{fe as default};
