import{_ as P,r as g,aJ as A,bm as z,q as F,s as j,v as J,aK as I,c as d,e as u,d as o,h as r,f as K,F as i,a4 as B,o as a,i as y,j as _,k as h,t as f,p as W,l as G,E as H}from"./index-ba92c6b8.js";import{E as L,a as O}from"./el-table-column-fef6b0da.js";import"./el-checkbox-55ac5a6b.js";import"./el-scrollbar-7101c886.js";import{C as X}from"./CommonPlan-b2bd4878.js";import{P as Y}from"./Pagination-db504da4.js";import"./isEqual-3fc68a3b.js";const V=k=>(W("data-v-9ac07766"),k=k(),G(),k),Z={class:"container"},w=V(()=>o("span",{class:"first"},"新增",-1)),ee=[w],te=V(()=>o("span",null,"修改",-1)),le=[te],ae=V(()=>o("span",null,"删除",-1)),oe=[ae],se=V(()=>o("span",null,"刷新",-1)),ue=[se],ne=V(()=>o("button",null,[o("span",null,"导入")],-1)),de=V(()=>o("button",null,[o("span",null,"导出")],-1)),re={class:"main"},ie={class:"bottom"},ce={__name:"outsourcedMaterial",setup(k){let Q=g(1),R=g(20);A();const c=z();F(),j();function T(t){R.value=t,c.getAllPage(Q.value,R.value,2).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}g([]),g([]);let v=!0;const C={result:{materialId:"",materialName:"",subReqBillNo:"",materialId2:"",materialName2:"",materialType:"",mustQty:"",pickedQty:"",goodReturnQty:"",processDefectReturnQty:""},chVersion:"",editable:!0},N=g([]);J(()=>{b()});function x(t){t.editable=!0}function D(){N.value.forEach(t=>{t.editable=!0})}const U=g(null);function M(){if(v)c.outsourcedMaterial.data.unshift({...C}),v=!1;else return}function m(t){t.result.id?(c.update({id:t.result.id,materialId:t.result.materialId,materialName:t.result.materialName,subReqBillNo:t.result.subReqBillNo,materialId2:t.result.materialId2,materialName2:t.result.materialName2,materialType:t.result.materialType,mustQty:t.result.mustQty,pickedQty:t.result.pickedQty,goodReturnQty:t.result.goodReturnQty,processDefectReturnQty:t.result.processDefectReturnQty},2).then(s=>{console.log("产能修改成功")}).catch(s=>{b(),console.log(t.id),console.log("产能修改失败")}),t.editable=!1):(c.add({materialId:t.result.materialId,materialName:t.result.materialName,subReqBillNo:t.result.subReqBillNo,materialId2:t.result.materialId2,materialName2:t.result.materialName2,materialType:t.result.materialType,mustQty:t.result.mustQty,pickedQty:t.result.pickedQty,goodReturnQty:t.result.goodReturnQty,processDefectReturnQty:t.result.processDefectReturnQty},2).then(s=>{v=!0,s.code==200?console.log("产能添加成功"):B.alert("数据不能为空","添加数据失败",{confirmButtonText:"好"}),b()}).catch(s=>{console.log(s),console.log("产能添加失败"),b()}),t.editable=!1)}function q(t){Q.value=t,c.getAllPage(t,R.value,2).then(s=>{console.log("获取分页表格数据成功")}).catch(s=>{})}function E(){const t=[];N.value.forEach(s=>{t.push(s.result.id)}),B.confirm("确定删除这些工序吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.deleteData(t,2).then(s=>{console.log("删除产能成功"),I({type:"success",message:"删除成功"}),b()}).catch(s=>{console.log(s),console.log("批量删除产能失败")})}).catch(()=>{I({type:"info",message:"取消删除"})})}function S(t){N.value=t}function b(){v=!0,c.getAllPage(Q.value,R.value,2).then(t=>{I({type:"success",message:"刷新成功"}),U.value.clearSelection()}).catch(t=>{}),console.log("查询所有工序产能")}return(t,s)=>{const n=O,p=H,$=L;return a(),d(i,null,[u(X,{class:"plan"}),o("div",Z,[o("div",{class:"head"},[o("button",{onClick:M},ee),o("button",{onClick:D},le),o("button",{onClick:E},oe),o("button",{onClick:b},ue),ne,de]),o("div",re,[u($,{data:K(c).outsourcedMaterial.data,border:"","cell-style":{borderColor:"#9db9d6",textAlign:"center"},"header-cell-style":{borderColor:"#9db9d6",background:"#d9e9f8",color:"#000",textAlign:"center",fontWeight:"500"},"row-key":"id",onSelectionChange:S,onRowDblclick:x,height:"62vh",ref_key:"myTable",ref:U},{default:r(()=>[u(n,{type:"selection","reserve-selection":!0,label:"",width:"35",class:"one"}),u(n,{prop:"result.materialId",label:"产品编码",width:"110"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialId,"onUpdate:modelValue":l=>e.result.materialId=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialId),1)],64))]),_:1}),u(n,{prop:"result.materialName",label:"产品名称",width:"280"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialName,"onUpdate:modelValue":l=>e.result.materialName=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialName),1)],64))]),_:1}),u(n,{prop:"result.subReqBillNo",label:"委外订单编号",width:"130"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.subReqBillNo,"onUpdate:modelValue":l=>e.result.subReqBillNo=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.subReqBillNo),1)],64))]),_:1}),u(n,{prop:"result.materialId2",label:"子项物料编码",width:"130"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialId2,"onUpdate:modelValue":l=>e.result.materialId2=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialId2),1)],64))]),_:1}),u(n,{prop:"result.materialName2",label:"子项物料名称",width:"230"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialName2,"onUpdate:modelValue":l=>e.result.materialName2=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialName2),1)],64))]),_:1}),u(n,{prop:"result.materialType",label:"子项类型",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.materialType,"onUpdate:modelValue":l=>e.result.materialType=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.materialType),1)],64))]),_:1}),u(n,{prop:"result.mustQty",label:"应发数量",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.mustQty,"onUpdate:modelValue":l=>e.result.mustQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.mustQty),1)],64))]),_:1}),u(n,{prop:"result.pickedQty",label:"已领数量",width:"85"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.pickedQty,"onUpdate:modelValue":l=>e.result.pickedQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.pickedQty),1)],64))]),_:1}),u(n,{prop:"result.goodReturnQty",label:"良品退料数量"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.goodReturnQty,"onUpdate:modelValue":l=>e.result.goodReturnQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.goodReturnQty),1)],64))]),_:1}),u(n,{prop:"result.processDefectReturnQty",label:"作业不良退料数量"},{default:r(({row:e})=>[e.editable?(a(),y(p,{key:0,modelValue:e.result.processDefectReturnQty,"onUpdate:modelValue":l=>e.result.processDefectReturnQty=l,onKeyup:_(l=>m(e),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])):(a(),d(i,{key:1},[h(f(e.result.processDefectReturnQty),1)],64))]),_:1}),u(n,{prop:"chVersion",label:"版本号",width:"120"})]),_:1},8,["data"])]),o("div",ie,[u(Y,{total:K(c).outsourcedMaterial.pages,onChangePage:q,onUpdateSize:T,totalRows:K(c).outsourcedMaterial.total},null,8,["total","totalRows"])])])],64)}}},ge=P(ce,[["__scopeId","data-v-9ac07766"]]);export{ge as default};
